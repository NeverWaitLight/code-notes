# Epic 1 Foundation & Core Delivery Pipeline

**Epic Goal**  
建立统一通知投递的最小可运行闭环：业务系统可以通过统一接口提交通知请求，系统完成鉴权、入队与基础处理，并能返回可追踪的状态。这一史诗确保平台基础能力可被集成验证，为后续路由与治理能力奠定基础。

## Story 1.1 统一发送 API 与鉴权

As a 业务系统研发团队,  
I want 通过统一 API 提交通知请求并通过鉴权校验,  
so that 我可以快速接入平台并安全地发起通知。

**Acceptance Criteria**

1. 统一发送 API 支持至少一个渠道的请求格式（可扩展至多渠道）。
2. API 必须进行发送方鉴权与权限校验（失败返回明确错误码）。
3. 请求校验覆盖必填字段、模板参数与目标地址格式。
4. 成功请求返回全局唯一的消息 ID 与初始状态（如 Queued）。
5. API 响应时间满足常规请求 SLA（与 NFR3 保持一致）。

## Story 1.2 异步投递处理闭环

As a 业务系统研发团队,  
I want 请求在后台被异步处理并进入投递流程,  
so that 我能获得稳定的投递处理能力且不阻塞业务线程。

**Acceptance Criteria**

1. 请求进入异步处理后，状态从 Queued 进入 Processing/Completed 的可见流转。
2. 至少完成一个“最小可运行投递闭环”（可为单一渠道/单一供应商/模拟投递）。
3. 投递失败时记录失败原因并进入失败状态。
4. 支持基础重试策略入口（细节在后续史诗完善）。

**Prerequisite**：Story 1.1

## Story 1.4 开发者接入产物与模板

As a 平台工程团队,  
I want 提供 server 项目、通道开发模板与可分发 JDK 包,  
so that 新渠道开发与业务系统接入更高效、标准化。

**Acceptance Criteria**

1. 后端 server 项目可独立构建与运行，作为统一通知平台服务入口。
2. 通道开发模板项目包含标准化接口与示例，支持快速接入新供应商。
3. 提供可分发的 JDK 打包产物，用于业务系统快速对接与运行依赖。
4. 模板与打包产物有基础文档说明其使用方式。

**Prerequisite**：Story 1.1## Epic 2 Routing & Resilience

**Epic Goal**  
引入智能路由与可靠性机制：在多供应商条件下自动选择最优投递路径，并在失败时进行故障转移与重试，确保送达率与可用性达到目标。

## Story 2.1 路由规则与供应商选择

As a 平台运营/可靠性团队,  
I want 配置路由规则并基于规则选择供应商,  
so that 系统可以按地址/语言/时间等条件自动路由。

**Acceptance Criteria**

1. 支持配置至少三类规则维度（如地址/语言/时间）。
2. 路由规则可按优先级排序并生效。
3. 每个规则可绑定一个或多个供应商候选。
4. 路由决策结果可在消息记录中追溯。

## Story 2.2 故障转移与重试策略

As a 平台运营/可靠性团队,  
I want 在供应商失败时自动故障转移并按策略重试,  
so that 提升送达率并降低单供应商波动影响。

**Acceptance Criteria**

1. 支持配置基础重试策略（次数 + 指数退避）。
2. 当供应商失败达到阈值时，自动切换至备用供应商。
3. 故障转移与重试过程记录在消息状态/日志中。
4. 失败最终状态可区分“已穷尽重试”。

**Prerequisite**：Story 2.1

## Story 2.3 优先级调度

As a 平台运营团队,  
I want 不同优先级的消息被不同队列策略处理,  
so that 紧急消息能更快送达。

**Acceptance Criteria**

1. 至少支持 Emergency/High/Normal/Low/Background 五级优先级。
2. 不同优先级映射到独立队列或调度策略。
3. 处理时延与优先级相关联（高优先级不低于低优先级的处理速度）。
4. 调度策略可配置，且默认配置可用。

**Prerequisite**：Story 1.2
