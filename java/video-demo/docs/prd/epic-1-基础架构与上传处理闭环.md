# Epic 1 基础架构与上传处理闭环

目标：建立后端可运行的最小闭环，完成项目骨架、数据库与本地存储配置、上传与分片处理，并提供查询与播放相关接口。该 epic 结束后，后端可独立完成“上传 → 分片 → 可播放”的链路验证。

## Story 1.1 项目骨架与基础配置

As a 开发者,
I want 初始化后端工程与本地存储/数据库配置，
so that 项目可以本机启动并具备最小运行基础。

### Acceptance Criteria

1. 后端为 Spring Boot + Maven 项目，可在本机启动运行。
2. SQLite 连接配置完成，应用可在指定路径创建数据库文件。
3. 视频与 HLS 输出目录可配置，启动时若目录不存在会自动创建。
4. 根目录包含 `backend/` 与 `frontend/` 两个独立目录结构。
5. 根目录提供 `startup.sh` 脚本，可启动后端；若存在前端目录与依赖，则可同时启动前端（开发模式）。

## Story 1.2 上传接口与元数据落库

As a 使用者,
I want 上传视频并生成元数据记录，
so that 系统可追踪上传状态与基础信息。

### Acceptance Criteria

1. 提供上传接口（multipart/form-data），支持上传 MP4（H.264）且大小 ≤ 5GB。
2. 上传成功后将原始视频保存到本地文件系统，生成唯一 ID。
3. 将视频元数据写入 SQLite（标题、原始文件名、大小、状态、创建时间、存储路径）。
4. 初始状态为“上传中”，失败时记录错误提示。
5. 提供视频列表查询接口，返回必要字段与状态。

## Story 1.3 HLS 分片处理与播放信息

As a 使用者,
I want 视频在上传后被分片并可播放，
so that 我可以通过 HLS 流畅播放。

### Acceptance Criteria

1. 上传完成后触发 JavaCV 异步分片处理，分片时长固定为 2 秒。
2. 成功后生成 `.m3u8` 与 `.ts` 文件并保存到本地目录。
3. 分片成功后状态更新为“上传完成”，失败则为“失败”并记录错误提示。
4. 提供视频详情接口，包含播放所需的 HLS 清单地址与状态。
5. 后端可通过静态资源或接口提供 HLS 文件访问。

## Story 1.4 删除接口

As a 使用者,
I want 删除已上传的视频，
so that 我可以清理不需要的内容。

### Acceptance Criteria

1. 提供删除接口，按视频 ID 删除数据库记录与本地文件（原始视频与 HLS 输出）。
2. 若文件或记录不存在，返回明确的错误提示。
